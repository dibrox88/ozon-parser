# ะฃะฟัะฐะฒะปะตะฝะธะต ะฐะฒัะพะทะฐะฟััะบะพะผ ัะตัะตะท Telegram ะฑะพั

## ๐๏ธ ะะพะผะฐะฝะดั ัะฟัะฐะฒะปะตะฝะธั cron

ะขะตะฟะตัั ะฒั ะผะพะถะตัะต ะฒะบะปััะฐัั ะธ ะพัะบะปััะฐัั ะฐะฒัะพะผะฐัะธัะตัะบะธะน ะทะฐะฟััะบ ะฟะฐััะตัะฐ ะฟััะผะพ ะธะท Telegram!

### ะะพัััะฟะฝัะต ะบะพะผะฐะฝะดั

#### `/cron_status` - ๐ ะัะพะฒะตัะธัั ััะฐััั ะฐะฒัะพะทะฐะฟััะบะฐ
ะะพะบะฐะทัะฒะฐะตั ัะตะบััะตะต ัะพััะพัะฝะธะต ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ะทะฐะฟััะบะฐ:
- โ ะะบะปััะตะฝ - cron ะฐะบัะธะฒะตะฝ
- โธ๏ธ ะัะบะปััะตะฝ - cron ะทะฐะบะพะผะผะตะฝัะธัะพะฒะฐะฝ
- โ ะะต ะฝะฐัััะพะตะฝ - ะทะฐะดะฐัะฐ ะฝะต ะฝะฐะนะดะตะฝะฐ

**ะะพะฟะพะปะฝะธัะตะปัะฝะพ ะฟะพะบะฐะทัะฒะฐะตั:**
- ะะฐัะฟะธัะฐะฝะธะต ะทะฐะฟััะบะฐ (*/15 9-21 * * *)
- ะะพัะปะตะดะฝะธะต 3 ะทะฐะฟะธัะธ ะธะท ะปะพะณะฐ cron

#### `/cron_on` - โฐ ะะบะปััะธัั ะฐะฒัะพะทะฐะฟััะบ
ะะบัะธะฒะธััะตั ะฐะฒัะพะผะฐัะธัะตัะบะธะน ะทะฐะฟััะบ ะฟะฐััะตัะฐ:
- ะะฐัะบะพะผะผะตะฝัะธััะตั ัััะพะบั ะฒ crontab
- ะะฐััะตั ะฝะฐัะฝะตั ะทะฐะฟััะบะฐัััั ะบะฐะถะดัะต 15 ะผะธะฝัั
- ะก 9:00 ะดะพ 21:00 ะะกะ (48 ัะฐะท ะฒ ะดะตะฝั)

#### `/cron_off` - โธ๏ธ ะัะบะปััะธัั ะฐะฒัะพะทะฐะฟััะบ
ะะตะฐะบัะธะฒะธััะตั ะฐะฒัะพะผะฐัะธัะตัะบะธะน ะทะฐะฟััะบ:
- ะะพะผะผะตะฝัะธััะตั ัััะพะบั ะฒ crontab (ะดะพะฑะฐะฒะปัะตั #)
- ะะฐััะตั ะฟะตัะตััะฐะฝะตั ะทะฐะฟััะบะฐัััั ะฐะฒัะพะผะฐัะธัะตัะบะธ
- ะะฐะดะฐัะฐ ัะพััะฐะฝัะตััั ะธ ะผะพะถะตั ะฑััั ะฒะบะปััะตะฝะฐ ัะฝะพะฒะฐ

## ๐ฏ ะกัะตะฝะฐัะธะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะกัะตะฝะฐัะธะน 1: ะัะบะปััะธัั ะฝะฐ ะฒัะตะผั ะพัะฟััะบะฐ
```
1. /cron_status     # ะัะพะฒะตััะตะผ, ััะพ ะฒะบะปััะตะฝ
2. /cron_off        # ะัะบะปััะฐะตะผ ะฝะฐ ะฒัะตะผั ะพัะฟััะบะฐ
   โ ะะฒัะพะทะฐะฟััะบ ะะขะะะฎะงะะ
   
   ... 2 ะฝะตะดะตะปะธ ะพัะฟััะบะฐ ...
   
3. /cron_on         # ะะบะปััะฐะตะผ ะพะฑัะฐัะฝะพ
   โ ะะฒัะพะทะฐะฟััะบ ะะะะฎะงะะ
```

### ะกัะตะฝะฐัะธะน 2: ะัะบะปััะธัั ะดะปั ะพะฑัะปัะถะธะฒะฐะฝะธั
```
1. /cron_off        # ะัะบะปััะฐะตะผ ะฐะฒัะพะทะฐะฟััะบ
2. /stop            # ะััะฐะฝะฐะฒะปะธะฒะฐะตะผ ัะตะบััะธะน ะฟัะพัะตัั (ะตัะปะธ ะทะฐะฟััะตะฝ)
3. ะะฑะฝะพะฒะธัั cookies ะฝะฐ ัะตัะฒะตัะต
4. /parse           # ะขะตััะพะฒัะน ะทะฐะฟััะบ
5. /cron_on         # ะะบะปััะฐะตะผ ะฐะฒัะพะทะฐะฟััะบ ะพะฑัะฐัะฝะพ
```

### ะกัะตะฝะฐัะธะน 3: ะัะพะฒะตัะบะฐ ัะฐะฑะพัั ะฐะฒัะพะทะฐะฟััะบะฐ
```
1. /cron_status     # ะกะผะพััะธะผ ััะฐััั ะธ ะฟะพัะปะตะดะฝะธะต ะทะฐะฟััะบะธ
   
   ๐ ะะพัะปะตะดะฝะธะต ะทะฐะฟััะบะธ:
   2025-11-01 09:00:01 - ะะฐะฟััะบ ะฟะฐััะตัะฐ...
   2025-11-01 09:15:01 - ะะฐะฟััะบ ะฟะฐััะตัะฐ...
   2025-11-01 09:30:01 - ะะฐะฟััะบ ะฟะฐััะตัะฐ...
```

### ะกัะตะฝะฐัะธะน 4: ะะตัะตะบะปััะตะฝะธะต ะฝะฐ ัััะฝะพะน ัะตะถะธะผ
```
1. /cron_off        # ะัะบะปััะฐะตะผ ะฐะฒัะพะทะฐะฟััะบ
2. ะัะฟะพะปัะทัะตะผ /parse ะบะพะณะดะฐ ะฝัะถะฝะพ ะทะฐะฟัััะธัั ะฟะฐััะตั
```

## ๐ ะกัะฐัััั ะบะพะผะฐะฝะด

### โ ะะฒัะพะทะฐะฟััะบ ะะะะฎะงะะ
```
๐ ะะฐัะฟะธัะฐะฝะธะต:
*/15 9-21 * * *

โฐ ะะฐะถะดัะต 15 ะผะธะฝัั ั 9:00 ะดะพ 21:00 ะะกะ
(48 ะทะฐะฟััะบะพะฒ ะฒ ะดะตะฝั)

ะัะฟะพะปัะทัะนัะต /cron_off ะดะปั ะพัะบะปััะตะฝะธั.
```

### โธ๏ธ ะะฒัะพะทะฐะฟััะบ ะะขะะะฎะงะะ
```
ะะฐะดะฐัะฐ cron ัััะตััะฒัะตั, ะฝะพ ะทะฐะบะพะผะผะตะฝัะธัะพะฒะฐะฝะฐ.

ะัะฟะพะปัะทัะนัะต /cron_on ะดะปั ะฒะบะปััะตะฝะธั.
```

### โ ะะฒัะพะทะฐะฟััะบ ะะ ะฝะฐัััะพะตะฝ
```
ะะฐะดะฐัะฐ cron ะดะปั ะฟะฐััะตัะฐ ะฝะต ะฝะฐะนะดะตะฝะฐ.
ะัะฟะพะปัะทัะนัะต setup-cron.sh ะดะปั ะฝะฐัััะพะนะบะธ.
```

### โน๏ธ ะฃะถะต ะฒะบะปััะตะฝ/ะพัะบะปััะตะฝ
```
ะะฒัะพะทะฐะฟััะบ ัะถะต ะฒะบะปััะตะฝ
ะะฐะดะฐัะฐ cron ัะถะต ะฐะบัะธะฒะฝะฐ.
```

## ๐ง ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั

### ะกัััะบัััะฐ crontab
```bash
# ะัะธะผะตั ะฐะบัะธะฒะฝะพะน ะทะฐะดะฐัะธ
*/15 9-21 * * * cd ~/ozon_parser && source venv/bin/activate && python main.py >> logs/cron.log 2>&1

# ะัะธะผะตั ะพัะบะปััะตะฝะฝะพะน ะทะฐะดะฐัะธ (ะทะฐะบะพะผะผะตะฝัะธัะพะฒะฐะฝะฐ)
# */15 9-21 * * * cd ~/ozon_parser && source venv/bin/activate && python main.py >> logs/cron.log 2>&1
```

### ะัะธ ะฒะบะปััะตะฝะธะธ (`/cron_on`)
1. ะะพั ัะธัะฐะตั ัะตะบััะธะน crontab: `crontab -l`
2. ะะฐัะพะดะธั ัััะพะบั ั `main.py` ะธ `ozon_parser`
3. ะฃะฑะธัะฐะตั ัะธะผะฒะพะป `#` ะฒ ะฝะฐัะฐะปะต ัััะพะบะธ
4. ะะฐะฟะธััะฒะฐะตั ะพะฑะฝะพะฒะปะตะฝะฝัะน crontab: `crontab -`

### ะัะธ ะพัะบะปััะตะฝะธะธ (`/cron_off`)
1. ะะพั ัะธัะฐะตั ัะตะบััะธะน crontab: `crontab -l`
2. ะะฐัะพะดะธั ัััะพะบั ั `main.py` ะธ `ozon_parser`
3. ะะพะฑะฐะฒะปัะตั ัะธะผะฒะพะป `#` ะฒ ะฝะฐัะฐะปะต ัััะพะบะธ
4. ะะฐะฟะธััะฒะฐะตั ะพะฑะฝะพะฒะปะตะฝะฝัะน crontab: `crontab -`

### ะัะธ ะฟัะพะฒะตัะบะต ััะฐัััะฐ (`/cron_status`)
1. ะงะธัะฐะตั crontab ะธ ะธัะตั ัััะพะบั ะฟะฐััะตัะฐ
2. ะัะพะฒะตััะตั ะฝะฐะปะธัะธะต `#` (ะทะฐะบะพะผะผะตะฝัะธัะพะฒะฐะฝะฐ = ะพัะบะปััะตะฝะฐ)
3. ะงะธัะฐะตั ะฟะพัะปะตะดะฝะธะต 5 ัััะพะบ ะธะท `~/ozon_parser/logs/cron.log`
4. ะคะพัะผะธััะตั ะพััะตั ะพ ััะฐัััะต

## โ๏ธ ะะฐะถะฝัะต ะทะฐะผะตัะฐะฝะธั

### ะะตะทะพะฟะฐัะฝะพััั
- ะะฐะดะฐัะฐ ะฝะต ัะดะฐะปัะตััั, ะฐ ัะพะปัะบะพ ะบะพะผะผะตะฝัะธััะตััั
- ะะพะถะฝะพ ะฑััััะพ ะฒะบะปััะธัั ะพะฑัะฐัะฝะพ
- ะะฐัััะพะนะบะธ ัะฐัะฟะธัะฐะฝะธั ัะพััะฐะฝััััั

### ะะณัะฐะฝะธัะตะฝะธั
- ะะพะผะฐะฝะดั ัะฐะฑะพัะฐัั ัะพะปัะบะพ ั cron-ะทะฐะดะฐัะตะน ะฟะฐััะตัะฐ
- ะะต ะฒะปะธััั ะฝะฐ ะดััะณะธะต ะทะฐะดะฐัะธ ะฒ crontab
- ะขัะตะฑัะตััั ะฟะตัะฒะพะฝะฐัะฐะปัะฝะฐั ะฝะฐัััะพะนะบะฐ ัะตัะตะท `setup-cron.sh`

### ะะตัะฒะพะฝะฐัะฐะปัะฝะฐั ะฝะฐัััะพะนะบะฐ
ะัะปะธ cron ะตัะต ะฝะต ะฝะฐัััะพะตะฝ:
```bash
ssh ozon@85.193.81.13
cd ~/ozon_parser
chmod +x setup-cron.sh
./setup-cron.sh
```

ะะพัะปะต ััะพะณะพ ะบะพะผะฐะฝะดั `/cron_on` ะธ `/cron_off` ะฑัะดัั ัะฐะฑะพัะฐัั.

## ๐ฑ ะะฑะฝะพะฒะปะตะฝะฝะพะต ะผะตะฝั ะบะพะผะฐะฝะด

```
/start        - ๐ ะะปะฐะฒะฝะพะต ะผะตะฝั
/parse        - ๐ ะะฐะฟัััะธัั ะฟะฐััะธะฝะณ
/stop         - โน๏ธ ะััะฐะฝะพะฒะธัั ะฟะฐััะธะฝะณ
/cron_on      - โฐ ะะบะปััะธัั ะฐะฒัะพะทะฐะฟััะบ (ะะะะะ!)
/cron_off     - โธ๏ธ ะัะบะปััะธัั ะฐะฒัะพะทะฐะฟััะบ (ะะะะะ!)
/cron_status  - ๐ ะกัะฐััั ะฐะฒัะพะทะฐะฟััะบะฐ (ะะะะะ!)
/status       - ๐ ะกัะฐััั ะฟะฐััะตัะฐ
/help         - โ ะกะฟัะฐะฒะบะฐ
```

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะขะตัั 1: ะัะพะฒะตัะบะฐ ััะฐัััะฐ
```
1. /cron_status
   # ะะพะปะถะฝะพ ะฟะพะบะฐะทะฐัั ัะตะบััะตะต ัะพััะพัะฝะธะต
```

### ะขะตัั 2: ะัะบะปััะตะฝะธะต ะฐะฒัะพะทะฐะฟััะบะฐ
```
1. /cron_status     # ะัะพะฒะตััะตะผ ััะพ ะฒะบะปััะตะฝ
2. /cron_off        # ะัะบะปััะฐะตะผ
3. /cron_status     # ะัะพะฒะตััะตะผ ััะพ ะพัะบะปััะตะฝ
```

### ะขะตัั 3: ะะบะปััะตะฝะธะต ะฐะฒัะพะทะฐะฟััะบะฐ
```
1. /cron_status     # ะัะพะฒะตััะตะผ ััะพ ะพัะบะปััะตะฝ
2. /cron_on         # ะะบะปััะฐะตะผ
3. /cron_status     # ะัะพะฒะตััะตะผ ััะพ ะฒะบะปััะตะฝ
```

### ะขะตัั 4: ะะพะฒัะพัะฝะพะต ะพัะบะปััะตะฝะธะต
```
1. /cron_off        # ะะตัะฒัะน ัะฐะท - ะพัะบะปััะธั
2. /cron_off        # ะัะพัะพะน ัะฐะท - ัะพะพะฑัะธั "ัะถะต ะพัะบะปััะตะฝ"
```

## ๐ ะัะพะฒะตัะบะฐ ะฝะฐ ัะตัะฒะตัะต

### ะัะพัะผะพัั crontab
```bash
ssh ozon@85.193.81.13 "crontab -l"
```

### ะัะพัะผะพัั ะปะพะณะพะฒ cron
```bash
ssh ozon@85.193.81.13 "tail -f ~/ozon_parser/logs/cron.log"
```

### ะััะฝะฐั ะฟัะพะฒะตัะบะฐ ะฐะบัะธะฒะฝะพััะธ
```bash
# ะะบะปััะธัั
ssh ozon@85.193.81.13 "crontab -l | grep -v '^#.*main.py'"

# ะัะบะปััะธัั
ssh ozon@85.193.81.13 "crontab -l | sed 's/^\([^#].*main.py.*\)/# \1/' | crontab -"
```

## ๐ก ะะพะปะตะทะฝัะต ะบะพะผะฑะธะฝะฐัะธะธ

### ะะพะปะฝะฐั ะพััะฐะฝะพะฒะบะฐ ะฒัะตะณะพ
```
/cron_off     # ะัะบะปััะฐะตะผ ะฐะฒัะพะทะฐะฟััะบ
/stop         # ะััะฐะฝะฐะฒะปะธะฒะฐะตะผ ัะตะบััะธะน ะฟัะพัะตัั
```

### ะะตัะตะทะฐะฟััะบ ะฐะฒัะพะผะฐัะธะทะฐัะธะธ
```
/cron_off     # ะัะบะปััะฐะตะผ
/cron_on      # ะะบะปััะฐะตะผ ัะฝะพะฒะฐ (ัะฑัะฐััะฒะฐะตั ัะพััะพัะฝะธะต)
```

### ะัะพะฒะตัะบะฐ ะฟะพัะปะต ะฒะบะปััะตะฝะธั
```
/cron_on      # ะะบะปััะฐะตะผ
/cron_status  # ะัะพะฒะตััะตะผ ััะพ ะฒะบะปััะธะปะพัั
```

## ๐ ะะพะฝะธัะพัะธะฝะณ

### ะะพะณะธ Telegram ะฑะพัะฐ
```bash
ssh ozon@85.193.81.13 "tail -f ~/ozon_parser/logs/telegram_bot.log"
```

ะั ัะฒะธะดะธัะต:
```
2025-11-01 15:30:45 | INFO | ะะบะปััะตะฝะธะต cron ะทะฐะฟัะพัะตะฝะพ ะฟะพะปัะทะพะฒะฐัะตะปะตะผ 123456789
2025-11-01 15:30:45 | INFO | ะะฐัะบะพะผะผะตะฝัะธัะพะฒะฐะฝะฐ ัััะพะบะฐ: */15 9-21 * * * ...
2025-11-01 15:30:46 | INFO | โ Cron ะฒะบะปััะตะฝ ััะฟะตัะฝะพ
```

### ะะพะณะธ ะฒัะฟะพะปะฝะตะฝะธั ะฟะฐััะตัะฐ
```bash
ssh ozon@85.193.81.13 "tail -f ~/ozon_parser/logs/cron.log"
```

## ๐ ะะฐะทะฒะตัััะฒะฐะฝะธะต

ะะพะผะฐะฝะดั ัะถะต ัะฐะทะฒะตัะฝััั ะฝะฐ ัะตัะฒะตัะต:
```
โ Telegram ะฑะพั ะทะฐะฟััะตะฝ! PID: 130630
โ ะะตะฝั ะบะพะผะฐะฝะด ะพะฑะฝะพะฒะปะตะฝะพ (8 ะบะพะผะฐะฝะด)
โ ะะพัััะฟะฝั ะบะพะผะฐะฝะดั ัะฟัะฐะฒะปะตะฝะธั cron
```

### ะัะพะฒะตัะบะฐ ะฒะตััะธะธ ะฑะพัะฐ
```bash
ssh ozon@85.193.81.13 "grep 'cron_' ~/ozon_parser/telegram_bot.py | wc -l"
# ะะพะปะถะฝะพ ะฒะตัะฝััั > 0 (ะตััั ััะฝะบัะธะธ ะดะปั ัะฐะฑะพัั ั cron)
```

ะัะต ะณะพัะพะฒะพ ะบ ะธัะฟะพะปัะทะพะฒะฐะฝะธั! ๐
