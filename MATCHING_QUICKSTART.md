# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º —Ç–æ–≤–∞—Ä–æ–≤

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

–ù–æ–≤—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤ v1.4.0:
- `gspread==6.0.0` - —Ä–∞–±–æ—Ç–∞ —Å Google Sheets
- `google-auth==2.27.0` - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Google API

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets

### 1. –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (5 –º–∏–Ω—É—Ç)

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [Google Cloud Console](https://console.cloud.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç "Ozon Parser"
3. –í–∫–ª—é—á–∏—Ç–µ API:
   - Google Sheets API
   - Google Drive API
4. –°–æ–∑–¥–∞–π—Ç–µ Service Account:
   - **Credentials** ‚Üí **Create Credentials** ‚Üí **Service Account**
   - –†–æ–ª—å: **Editor**
5. –°–æ–∑–¥–∞–π—Ç–µ JSON –∫–ª—é—á:
   - **Keys** ‚Üí **Add Key** ‚Üí **Create new key** ‚Üí **JSON**
6. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª –∫–∞–∫ `google_credentials.json` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞

### 2. –î–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫ —Ç–∞–±–ª–∏—Ü–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ `google_credentials.json`
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è `"client_email"`
3. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à—É Google Sheets —Ç–∞–±–ª–∏—Ü—É
4. **Share** ‚Üí –≤—Å—Ç–∞–≤—å—Ç–µ email ‚Üí –¥–∞–π—Ç–µ –ø—Ä–∞–≤–∞ **Viewer**

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env

```bash
GOOGLE_SHEETS_URL=https://docs.google.com/spreadsheets/d/1JsvsWxlDZN4zV-BwFDTIOpZSElLKdh_mkTqP_fpPUhk/edit?gid=1473954199
GOOGLE_CREDENTIALS_FILE=google_credentials.json
```

üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: [GOOGLE_SHEETS_SETUP.md](GOOGLE_SHEETS_SETUP.md)

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã

–í–∞—à–∞ Google Sheets —Ç–∞–±–ª–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

```
| –¶–µ–Ω–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ      | –¢–∏–ø    | –¶–µ–Ω–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ      | –¢–∏–ø    | ... |
|------|---------------|--------|------|---------------|--------|-----|
| 1000 | –ö–æ—Ä–ø—É—Å Q11    | –∫–æ–º–ø   | 2000 | –ê–¥–∞–ø—Ç–µ—Ä Wi-Fi | —Ä–∞—Å—Ö   | ... |
| 1500 | –ö—É–ª–µ—Ä CPU     | –∫–æ–º–ø   | 500  | –¢–µ—Ä–º–æ–ø–∞—Å—Ç–∞    | —Ä–∞—Å—Ö   | ... |
```

**–ö–∞–∂–¥—ã–µ 3 —Å—Ç–æ–ª–±—Ü–∞**: –¶–µ–Ω–∞ (—Å–ø—Ä–∞–≤–∫–∞) | –ù–∞–∑–≤–∞–Ω–∏–µ | –¢–∏–ø

**–î–∏–∞–ø–∞–∑–æ–Ω —á—Ç–µ–Ω–∏—è**: A:AU (—Å—Ç–æ–ª–±—Ü—ã –æ—Ç A –¥–æ AU)

## üöÄ –ó–∞–ø—É—Å–∫

```bash
python main.py
```

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. ‚úÖ –ü–∞—Ä—Å–∏—Ç –∑–∞–∫–∞–∑—ã —Å Ozon
2. ‚úÖ –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Google Sheets
3. ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤
4. ‚úÖ –°–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–≤–∞—Ä—ã –∏–∑ –∑–∞–∫–∞–∑–æ–≤ —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º
5. ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ JSON —Å –ø–æ–ª—è–º–∏ `mapped_name` –∏ `mapped_type`

## üìÅ –†–µ–∑—É–ª—å—Ç–∞—Ç

### JSON —Å —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º–∏

–§–∞–π–ª: `ozon_orders_2025-XX-XX_XX-XX-XX.json`

```json
{
  "orders": [
    {
      "order_number": "46206571-0580",
      "items": [
        {
          "name": "–ö–æ—Ä–ø—É—Å Invader Q11 –∫—É–±–∏–∫ + 3 ARGB –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞...",
          "color": "White",
          "quantity": 5,
          "price": 4098.0,
          "status": "–∑–∞–±—Ä–∞—Ç—å",
          "mapped_name": "–ö–æ—Ä–ø—É—Å –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–π Q11",
          "mapped_type": "–∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ"
        }
      ]
    }
  ]
}
```

### –ö–µ—à —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–π

–§–∞–π–ª: `product_mappings.json`

–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ —Å–≤—è–∑–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

## üéØ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–µ—à–∞
```
–¢–æ–≤–∞—Ä —É–∂–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–ª—Å—è? ‚Üí –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
```

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
```
–ò—â–µ–º –ø–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ:
- –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ (100%)
- –ß–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ (80%)
- –ü–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º (30-70%)
```

### 3. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```
Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:
üîç –ù–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
–¢–æ–≤–∞—Ä: –ö–æ—Ä–ø—É—Å Invader Q11...
‚Üí –ö–æ—Ä–ø—É—Å –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–π Q11 (–∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ) [85%]

–û—Ç–ø—Ä–∞–≤—å—Ç–µ OK –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
```

### 4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
```
–°–≤—è–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ product_mappings.json
–ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

## üîç –¢–∏–ø –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

–ï—Å–ª–∏ —Ç–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∫–∞—Ç–∞–ª–æ–≥–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–∏–ø: **"—Ä–∞—Å—Ö–æ–¥–Ω–∏–∫–∏"**

–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ `product_matcher.py`:

```python
class ProductMatcher:
    DEFAULT_TYPE = "—Ä–∞—Å—Ö–æ–¥–Ω–∏–∫–∏"  # –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π
```

## üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Google Sheets

```bash
python -c "from sheets_manager import SheetsManager; from config import Config; sm = SheetsManager(Config.GOOGLE_CREDENTIALS_FILE); print('‚úÖ OK' if sm.connect() else '‚ùå –û—à–∏–±–∫–∞')"
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤

```bash
python -c "
from sheets_manager import SheetsManager
from config import Config

sm = SheetsManager(Config.GOOGLE_CREDENTIALS_FILE)
if sm.connect():
    products = sm.load_products_from_sheet(Config.GOOGLE_SHEETS_URL)
    print(f'–ó–∞–≥—Ä—É–∂–µ–Ω–æ: {len(products)} —Ç–æ–≤–∞—Ä–æ–≤')
    for p in products[:5]:
        print(f'  ‚Ä¢ {p[\"name\"]} - {p[\"type\"]}')
"
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–π

```bash
python -c "
import json
from pathlib import Path

if Path('product_mappings.json').exists():
    with open('product_mappings.json') as f:
        mappings = json.load(f)
    print(f'–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–π: {len(mappings)}')
    for key, val in list(mappings.items())[:3]:
        print(f'  ‚Ä¢ {val[\"original_name\"]} ‚Üí {val[\"mapped_name\"]}')
else:
    print('–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–π –ø–æ–∫–∞ –Ω–µ—Ç')
"
```

## üõ†Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–µ—à–µ–º

### –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è

```bash
# Windows PowerShell
Remove-Item product_mappings.json

# Linux/Mac
rm product_mappings.json
```

### –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ

–û—Ç–∫—Ä–æ–π—Ç–µ `product_mappings.json` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ –Ω—É–∂–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:

```json
{
  "–∫–æ—Ä–ø—É—Å warrior z5|black": {
    "mapped_name": "–ö–æ—Ä–ø—É—Å –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–π Warrior",
    "mapped_type": "–∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ"
  }
}
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [GOOGLE_SHEETS_SETUP.md](GOOGLE_SHEETS_SETUP.md) - –ü–æ–¥—Ä–æ–±–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets API
- [PRODUCT_MATCHING.md](PRODUCT_MATCHING.md) - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—é
- [CHANGELOG.md](CHANGELOG.md) - –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π

## ‚ùì –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### Google Sheets –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª `google_credentials.json` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Service Account email –¥–æ–±–∞–≤–ª–µ–Ω –≤ –¥–æ—Å—Ç—É–ø—ã –∫ —Ç–∞–±–ª–∏—Ü–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ API –≤–∫–ª—é—á–µ–Ω—ã –≤ Google Cloud Console

### –¢–æ–≤–∞—Ä—ã –Ω–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã (–∫–∞–∂–¥—ã–µ 3 —Å—Ç–æ–ª–±—Ü–∞)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏—è –∏ —Ç–∏–ø—ã –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω —á—Ç–µ–Ω–∏—è (A:AU)

### –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è

1. –£–¥–∞–ª–∏—Ç–µ `product_mappings.json`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–∞—Ä—Å–µ—Ä –∑–∞–Ω–æ–≤–æ
3. –ò–ª–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª –≤—Ä—É—á–Ω—É—é

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –≤–∞—à –ø–∞—Ä—Å–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –ü–∞—Ä—Å–∏—Ç –∑–∞–∫–∞–∑—ã —Å Ozon
- ‚úÖ –°–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–≤–∞—Ä—ã —Å –≤–∞—à–∏–º –∫–∞—Ç–∞–ª–æ–≥–æ–º
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ–±–æ–≥–∞—â—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ JSON
- ‚úÖ –ö–µ—à–∏—Ä—É–µ—Ç —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–∞–±–æ—Ç—ã

–°–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—É—Å–∫ –±—É–¥–µ—Ç –µ—â—ë –±—ã—Å—Ç—Ä–µ–µ –±–ª–∞–≥–æ–¥–∞—Ä—è –∫–µ—à—É! üöÄ
